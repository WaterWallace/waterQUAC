% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/daysAboveThreshold.R
\name{daysAboveThreshold}
\alias{daysAboveThreshold}
\title{Detect gradual sensor drift in time series water quality data}
\usage{
daysAboveThreshold(data, threshold, type = NULL, dryperiod = 5)
}
\arguments{
\item{data}{A data frame containing time series data.}

\item{threshold}{A numeric to calculate how long is exceeded}

\item{type}{A string. "rising" or "falling" (or NULL)}
}
\value{
A vector (in days)
}
\description{
This function detects sustained periods where sensor readings remain consistently
above a calculated threshold, which may indicate sensor drift. The threshold is
defined as a multiple of the median value, and drift is flagged if readings exceed
this threshold continuously for longer than a specified number of days.
}
\details{
If a column matching "quality" (case-insensitive) exists in the data, drift flags
will be written to it. Otherwise, a new column `quality` is created.
}
\note{
The input data frame (`data`) must include:

| Column Name | Type      | Description                                       |
|-------------|-----------|---------------------------------------------------|
| `<time_col>` | POSIXct   | Timestamp of each observation                     |
| `<value_col>`| numeric   | Measured sensor value                             |

All other columns in the input data frame will be preserved in the output.
}
\examples{
library(dplyr)
# Simulated data
set.seed(42)
ts <- seq.POSIXt(from = as.POSIXct("2024-01-01"), by = "hour", length.out = 200)
val <- c(rnorm(150, mean = 2), rep(6, 50))  # final 50 points simulate drift
df <- data.frame(ts = ts, Value = val, Quality = NA_character_)
df <- df \%>\% mutate(daysAbove = daysAboveThreshold(., 2))
plot(df$ts, df$daysAbove)
}
